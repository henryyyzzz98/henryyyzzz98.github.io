<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>MSNZ Draft Planner</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&display=swap');

    body {
      font-family: "Inter", sans-serif;
      background: #f4f4f4;
      text-align: center;
    }
    h1 { margin: 20px 0; }

    #draft-area { display: flex; justify-content: space-between; margin: 20px; }
    #available { flex: 1.5; margin-right: 20px; }
    #teams { flex: 1.25; }

    /* Available player grid */
    #playerGrid {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 10px;
      justify-items: center;
      margin: 20px auto;
      width: fit-content;
      list-style: none;
      padding: 0;
    }

    .player-icon {
      position: relative;
      width: 80px;
      height: 80px;
      border-radius: 10px;
      overflow: hidden;
      cursor: grab;
      border: 2px solid #ccc;
    }

    .player-icon img, .player-icon span {
      pointer-events: none; /* Fix drag issue */
    }

    .player-icon img { width: 100%; height: 100%; object-fit: cover; display: block; }

    .player-icon span {
      position: absolute;
      bottom: 0;
      width: 100%;
      height: 25%;
      background: rgba(0,0,0,0.5);
      color: white;
      font-size: 12px;
      text-align: center;
      line-height: 1.8;
    }

    /* Team rows */
    .team-row {
      display: flex;
      align-items: center;
      justify-content: flex-start;
      border: 2px solid #333;
      border-radius: 10px;
      padding: 10px;
      margin: 15px auto;
      background: white;
      min-height: 60px;
      width: 60%;
    }
    .team-name { font-weight: bold; width: 50px; margin-right: 10px; }

    .team-slot { display: flex; flex-wrap: wrap; gap: 6px; }
    .team-slot.drag-over { border: 2px dashed #007bff; background: #e9f5ff; }

    /* Drafted icons smaller */
    .team-slot .player-icon { width: 60px; height: 60px; }
    .team-slot .player-icon span { font-size: 9px; }

    /* Leaders */
    .player-icon.leader {
      background: #ffeeba;
      border: 2px solid #ff9800;
      cursor: default;
    }

    button {
      margin: 10px;
      padding: 8px 14px;
      border: none;
      border-radius: 6px;
      background: #007bff;
      color: white;
      cursor: pointer;
    }
    button:hover { background: #0056b3; }
  </style>
</head>
<body>
  <h1>MSNZ Draft Planner</h1>

  <div id="draft-area">
    <div id="available">
      <h2>Available Members</h2>
      <ul id="playerGrid"></ul>
    </div>

    <div id="teams">
      <h2>Units</h2>
      <div class="team-row">
        <div class="team-name">Moon</div>
        <ul id="team-Moon" class="team-slot"></ul>
      </div>
      <div class="team-row">
        <div class="team-name">Sun</div>
        <ul id="team-Sun" class="team-slot"></ul>
      </div>
      <div class="team-row">
        <div class="team-name">Neptune</div>
        <ul id="team-Neptune" class="team-slot"></ul>
      </div>
      <div class="team-row">
        <div class="team-name">Zenith</div>
        <ul id="team-Zenith" class="team-slot"></ul>
      </div>
    </div>
  </div>

  <button id="undoBtn">Undo Last Pick</button>
  <button id="autoFillBtn">Auto Fill Remaining</button>

  <script>
    const profileImageUrl = {
      SeoYeon:"https://static.cosmo.fans/uploads/member-profile/2025-05-01/S1.jpg",
      HyeRin:"https://static.cosmo.fans/uploads/member-profile/2025-05-01/S2.jpg",
      JiWoo:"https://static.cosmo.fans/uploads/member-profile/2025-05-01/S3.jpg",
      ChaeYeon:"https://static.cosmo.fans/uploads/member-profile/2025-05-01/S4.jpg",
      YooYeon:"https://static.cosmo.fans/uploads/member-profile/2025-05-01/S5.jpg",
      SooMin:"https://static.cosmo.fans/uploads/member-profile/2025-05-01/S6.jpg",
      NaKyoung:"https://static.cosmo.fans/uploads/member-profile/2025-05-01/S7.jpg",
      YuBin:"https://static.cosmo.fans/uploads/member-profile/2025-05-01/S8.jpg",
      Kaede:"https://static.cosmo.fans/uploads/member-profile/2025-05-01/S9.jpg",
      DaHyun:"https://static.cosmo.fans/uploads/member-profile/2025-05-01/S10.jpg",
      Kotone:"https://static.cosmo.fans/uploads/member-profile/2025-05-01/S11.jpg",
      YeonJi:"https://static.cosmo.fans/uploads/member-profile/2025-05-01/S12.jpg",
      Nien:"https://static.cosmo.fans/uploads/member-profile/2025-05-01/S13.jpg",
      SoHyun:"https://static.cosmo.fans/uploads/member-profile/2025-05-01/S14.jpg",
      Xinyu:"https://static.cosmo.fans/uploads/member-profile/2025-05-01/S15.jpg",
      Mayu:"https://static.cosmo.fans/uploads/member-profile/2025-05-01/S16.jpg",
      Lynn:"https://static.cosmo.fans/uploads/member-profile/2025-05-01/S17.jpg",
      JooBin:"https://static.cosmo.fans/uploads/member-profile/2025-05-01/S18.jpg",
      HaYeon:"https://static.cosmo.fans/uploads/member-profile/2025-05-01/S19.jpg",
      ShiOn:"https://static.cosmo.fans/uploads/member-profile/2025-05-01/S20.jpg",
      ChaeWon:"https://static.cosmo.fans/uploads/member-profile/2025-05-01/S21.jpg",
      Sullin:"https://static.cosmo.fans/uploads/member-profile/2025-05-01/S22.jpg",
      SeoAh:"https://static.cosmo.fans/uploads/member-profile/2025-05-01/S23.jpg",
      JiYeon:"https://static.cosmo.fans/uploads/member-profile/2025-05-01/S24.jpg"
    };

    const leaders = { Moon:"Sullin", Sun:"Xinyu", Neptune:"SeoYeon", Zenith:"HaYeon" };
    const teamNames = ["Moon","Sun","Neptune","Zenith"];
    const playerSNumber = {
      SeoYeon: "S1", HyeRin: "S2", JiWoo: "S3", ChaeYeon: "S4", YooYeon: "S5",
      SooMin: "S6", NaKyoung: "S7", YuBin: "S8", Kaede: "S9", DaHyun: "S10",
      Kotone: "S11", YeonJi: "S12", Nien: "S13", SoHyun: "S14", Xinyu: "S15",
      Mayu: "S16", Lynn: "S17", JooBin: "S18", HaYeon: "S19", ShiOn: "S20",
      ChaeWon: "S21", Sullin: "S22", SeoAh: "S23", JiYeon: "S24"
    };

    let players = Object.keys(profileImageUrl).filter(p => !Object.values(leaders).includes(p));
    let history = [];
    const gridContainer = document.getElementById("playerGrid");

    function renderAvailablePlayers() {
      gridContainer.innerHTML = "";
      players.forEach(player => {
        const li = document.createElement("li");
        li.className = "player-icon";
        li.draggable = true;
        li.dataset.name = player;

        const img = document.createElement("img");
        img.src = profileImageUrl[player];
        img.alt = player;

        const span = document.createElement("span");
        span.textContent = playerSNumber[player];

        li.appendChild(img);
        li.appendChild(span);

        li.addEventListener("dragstart", e => {
          e.dataTransfer.setData("text/plain", player);
        });

        gridContainer.appendChild(li);
      });
    }

    function addLeaders(){
      Object.entries(leaders).forEach(([team,leader])=>{
        const slot = document.getElementById("team-"+team);
        const li = document.createElement("li");
        li.className="player-icon leader";
        li.innerHTML=`<img src="${profileImageUrl[leader]}" alt="${leader}"><span>Leader</span>`;
        slot.appendChild(li);
      });
    }

    function draftPlayer(player, slot) {
      if (!players.includes(player) || slot.children.length >= 6) return;

      const li = document.createElement("li");
      li.className = "player-icon";
      li.innerHTML = `<img src="${profileImageUrl[player]}" alt="${player}">
                      <span>${playerSNumber[player]}</span>`;

      slot.appendChild(li);

      history.push({ player, slot });
      players = players.filter(p => p !== player);
      renderAvailablePlayers();
    }

    // Setup drag/drop
    teamNames.forEach(team=>{
      const slot = document.getElementById("team-"+team);
      slot.addEventListener("dragover", e => { e.preventDefault(); slot.classList.add("drag-over"); });
      slot.addEventListener("dragleave", () => slot.classList.remove("drag-over"));
      slot.addEventListener("drop", e => {
        e.preventDefault();
        slot.classList.remove("drag-over");
        draftPlayer(e.dataTransfer.getData("text/plain"), slot);
      });
    });

    // Undo
    document.getElementById("undoBtn").addEventListener("click",()=>{
      const last = history.pop();
      if(!last) return;
      const {player, slot} = last;
      [...slot.children].forEach(child => { if(child.textContent.includes(player)) child.remove(); });
      players.push(player);
      renderAvailablePlayers();
    });

    // Auto fill
    document.getElementById("autoFillBtn").addEventListener("click",()=>{
      let remaining = [...players];
      for(let i=remaining.length-1;i>0;i--){
        const j=Math.floor(Math.random()*(i+1));
        [remaining[i],remaining[j]] = [remaining[j],remaining[i]];
      }
      let teamIndex=0;
      remaining.forEach(player=>{
        for(let tries=0; tries<teamNames.length; tries++){
          const teamName=teamNames[teamIndex];
          const slot=document.getElementById("team-"+teamName);
          if(slot.children.length<6){ draftPlayer(player, slot); break; }
          teamIndex=(teamIndex+1)%teamNames.length;
        }
        teamIndex=(teamIndex+1)%teamNames.length;
      });
      players = players.filter(player => !teamNames.some(team => document.getElementById("team-"+team).textContent.includes(player)));
      renderAvailablePlayers();
    });

    addLeaders();
    renderAvailablePlayers();
  </script>
</body>
</html>