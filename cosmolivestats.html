<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>COSMO LIVE Stats</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Gabarito:wght@400..900&display=swap" rel="stylesheet">
  <style>
        /* Global box-sizing for easier sizing */
        * {
          box-sizing: border-box;
        }

        body {
            background-color: #000;
            color: #fff;
            font-family: "Gabarito", sans-serif;
            margin: 0;
            padding: 20px;
        }

        .container {
          max-width: 1000px;  /* Set max width */
          margin: 0 auto;     /* Center horizontally */
          padding: 0 20px;    /* Side padding */
        }

        h1 {
            text-align: center;
            color: #FFE433;
        }

        h2 {
          text-align: center;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            background-color: #111;
            color: #fff;
            margin-top: 20px;
        }

        th, td {
            border: 1px solid #333;
            padding: 10px;
            text-align: left;
        }

        th {
            background-color: #222;
            color: #FFE433;
        }

        tr:nth-child(even) {
            background-color: #1a1a1a;
        }

        tr:hover {
            background-color: #333;
        }

        #table2 th:nth-child(2),
        #table2 td:nth-child(2) {
          width: 5px;
        }

        #table3 th:nth-child(2),
        #table3 td:nth-child(2) {
          width: 5px;
        }
        </style>
</head>
<body>
  <div class="container">
    <h1>COSMO LIVE Dashboard</h1>

    <h2>Summary</h2>
    <table id="table1"></table>

    <h2>Cosmo Live Ranking</h2>
    <table id="table2"></table>

    <h2>(Sorted by Total Duration)</h2>
    <table id="table3"></table>
  </div>
  
  <script>
    const nameColorMap = {
      SeoYeon: "#22aeff",
      HyeRin: "#7e00ff",
      JiWoo: "#ffff00",
      ChaeYeon: "#98c64a",
      YooYeon: "#d10a6f",
      SooMin: "#fc83a4",
      NaKyoung: "#6599a4",
      YuBin: "#ffe3e2",
      Kaede: "#ffc935",
      DaHyun: "#ff9ad6",
      Kotone: "#fde000",
      YeonJi: "#5974ff",
      Nien: "#ff953f",
      SoHyun: "#1222b5",
      Xinyu: "#d51313",
      Mayu: "#fe8e76",
      Lynn: "#ab61b8",
      JooBin: "#b8f54d",
      HaYeon: "#52d9ba",
      ShiOn: "#ff428a",
      ChaeWon: "#c7a3e0",
      Sullin: "#7aba8c",
      SeoAh: "#cff2ff",
      JiYeon: "#ffab61"
    };

    function getColorForName(name) {
      return nameColorMap[name] || '';
    }
    
    fetch("https://docs.google.com/spreadsheets/d/1jXjnPCKMrbGBhk0wUBLv66YAhcIWO2xZ2yTTL1-LMIM/gviz/tq?tqx=out:json")
      .then(res => res.text())
      .then(text => {
        const json = JSON.parse(text.substr(47).slice(0, -2));
        const rows = json.table.rows;

        function buildTable(elementId, colIndexes, allRows, rowLimit = null) {
            const table = document.getElementById(elementId);

            // Create header row
            const header = table.insertRow();
            colIndexes.forEach(i => {
            const th = document.createElement('th');
            th.innerText = json.table.cols[i]?.label || ``;
            header.appendChild(th);
        });

          const slicedRows = rowLimit ? allRows.slice(0, rowLimit) : allRows;

        slicedRows.forEach(r => {
          const row = table.insertRow();
          colIndexes.forEach(i => {
            const cell = row.insertCell();
            cell.innerText = r.c[i]?.f || r.c[i]?.v || '';

              // Color column 12 in table2 based on col 13 name
              if (elementId === "table2" && i === 12) {
                const name = r.c[13]?.v || '';
                cell.style.backgroundColor = getColorForName(name);
              }

              // Color column 20 in table3 based on col 21 name
              if (elementId === "table3" && i === 20) {
                const name = r.c[21]?.v || '';
                cell.style.backgroundColor = getColorForName(name);
              }
          });
        });
      }

        // Table 1: A to E → Index 0–4
        buildTable("table1", [0, 1, 2, 3, 4], rows);

        // Table 2: L to R → Index 11–17
        buildTable("table2", [11, 12, 13, 14, 15, 16, 17], rows, 24);

        // Table 3: T to X → Index 19–23
        buildTable("table3", [19, 20, 21, 22, 23], rows, 24);
      });
  </script>
</body>
</html>
